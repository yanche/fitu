
var validate = require('validate');

//input: image base64 string
//output: {'data':, 'type'}
var getImageUploadFormat = function (imgbase64) {
    var ret = { 'data': _getImageDataFromBase64String(imgbase64), 'mime': _getContentTypeFromBase64String(imgbase64) };
    return ret;
};

var _getContentTypeFromBase64String = function (base64) {
    if (!validate.picBase64(base64))
        return '';
    
    var start = base64.indexOf(':');
    var end = base64.indexOf(';');
    if (start < 0 || end < 0 || start >= end)
        return '';
    
    return base64.slice(start + 1, end);
};

var _getImageDataFromBase64String = function (base64) {
    if (!validate.picBase64(base64))
        return '';
    
    return base64.slice(base64.indexOf(',') + 1);
};

exports.getImageUploadFormat = getImageUploadFormat;
