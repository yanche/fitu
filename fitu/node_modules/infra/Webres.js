var constants = require('const');

var Webres = function (code, type, content, headers) {
    this.code = code;
    this.type = type || constants.mime.plain;
    this.content = content || '';
    this.headers = headers || {};
};

Webres.prototype.response = function (res) {
    res.setHeader('Content-Type', this.type);
    if (this.headers) {
        for (var h in this.headers)
            res.setHeader(h, this.headers[h]);
    }
    if (!this.headers.Server) {
        res.setHeader('Server', 'yanche');
    }
    res.writeHead(this.code);
    res.end(this.content);
};

Webres.prototype.setHeader = function (key, val) {
    this.headers[key] = val;
};

Webres.prototype.toLogEntry = function () {
    return {
        statusCode: this.code,
        type: this.type,
        content: this.content,
        headers: this.headers
    };
};

module.exports = Webres;