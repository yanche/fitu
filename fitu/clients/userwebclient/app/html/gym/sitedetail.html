<loading class="col-xs-12" show="loading" word="lang.GLOBAL_MSG_LOADING"></loading>
<div class="col-xs-12 paddingLR0px" show="!loading">
    <div class="col-xs-12 paddingLR0px" style="position:relative;">
        <img style="width:100%;" ng-src="{{site.picUrl}}" />
        <div style="position:absolute;bottom:0px;right:0px;left:0px;background-color:black;color:white;opacity:0.6;min-height:25%;">
            <div style="font-size:150%;padding:5px 10px;overflow:hidden;text-overflow:ellipsis;" ng-bind="site.name"></div>
            <div style="padding:5px 10px;overflow:hidden;text-overflow:ellipsis;">
                <span ng-bind="lang.SITEDETAIL_LABEL_OPENTIME"></span>
                <span ng-bind="site.open.startsOn | siteopen | datetime : const.timeAFormat"></span>
                <span> ~ </span>
                <span ng-bind="site.open.endsOn | siteopen | datetime : const.timeAFormat"></span>
            </div>
        </div>
    </div>
    <div class="empty-xs"></div>
    <div class="col-xs-12">
        <div class="col-xs-12 paddingLR0px fontbold" ng-bind="lang.SITEDETAIL_LABEL_ADDR"></div>
        <div class="col-xs-12 paddingLR0px" ng-click="goLocation()">
            <i class="fa fa-map-marker blue"></i>
            <span ng-bind="site.location.address"></span>
        </div>
        <div class="col-xs-12 paddingLR0px fontbold" ng-bind="lang.SITEDETAIL_LABEL_CONTSITE"></div>
        <div class="col-xs-12 paddingLR0px">
            <i class="fa fa-phone"></i>
            <span ng-bind="site.contact"></span>
        </div>
        <div class="col-xs-12 paddingLR0px fontbold" ng-bind="lang.SITEDETAIL_LABEL_PRICES"></div>
        <div class="col-xs-12 paddingLR0px" ng-repeat="p in site.prices">
            <i class="fa fa-rmb"></i>
            <span ng-bind="p | price"></span>
        </div>
        <div class="col-xs-12 paddingLR0px fontbold" ng-bind="lang.SITEDETAIL_LABEL_INTRO"></div>
        <div class="col-xs-12 paddingLR0px">
            <i class="fa fa-info"></i>
            <span ng-bind="site.intro"></span>
        </div>
        <div class="col-xs-12 paddingLR0px fontbold" ng-bind="lang.SITEDETAIL_LABEL_VENDOR"></div>
        <div class="col-xs-12 paddingLR0px" ng-click="goVendorDetail(site.vendor)">
            <div class="col-xs-1 paddingLR0px">
                <img ng-src="{{site.vendor.logoUrl}}" style="width:100%;" />
            </div>
            <div class="col-xs-11 paddingLR0px" style="padding-left: 10px;" ng-bind="site.vendor.name"></div>
        </div>
        <div class="col-xs-12 paddingLR0px fontbold">
            <span ng-bind="lang.SITEDETAIL_LABEL_FANSCOUNT"></span>
            <i class="fa fa-heart" ng-class="{red: site.fansCount > 0}"></i>
            <span ng-bind="site.fansCount"></span>
        </div>
        <loading class="col-xs-12 paddingLR0px" show="loadingFanRel" word="lang.GLOBAL_MSG_LOADING"></loading>
        <div class="col-xs-12 paddingLR0px" ng-show="!loadingFanRel && user">
            <div class="col-xs-12 paddingLR0px" ng-show="fanRelationship.subscribe">
                <span ng-bind="lang.SITEDETAIL_LABEL_FAN"></span>
                <button class="btn btn-danger btn-xs" ng-click="noFan()" ng-disabled="nofanning">
                    <i class="fa fa-spinner fa-spin" ng-show="nofanning"></i>
                    <span ng-bind="lang.SITEDETAIL_BTN_NOFANNING" ng-show="nofanning"></span>
                    <span ng-bind="lang.SITEDETAIL_BTN_NOFAN" ng-show="!nofanning"></span>
                </button>
            </div>
            <div class="col-xs-12 paddingLR0px" ng-show="!fanRelationship.subscribe">
                <span ng-bind="lang.SITEDETAIL_LABEL_NOFAN"></span>
                <button class="btn btn-success btn-xs" ng-click="fan()" ng-disabled="fanning">
                    <i class="fa fa-spinner fa-spin" ng-show="fanning"></i>
                    <span ng-bind="lang.SITEDETAIL_BTN_FANNING" ng-show="fanning"></span>
                    <span ng-bind="lang.SITEDETAIL_BTN_FAN" ng-show="!fanning"></span>
                </button>
            </div>
        </div>
        <div class="col-xs-12 paddingLR0px small" ng-bind="lang.SITEDETAIL_MSG_WHYFAN_LOGIN" ng-show="user"></div>
        <div class="col-xs-12 paddingLR0px small" ng-bind="lang.SITEDETAIL_MSG_WHYFAN_NOLOGIN" ng-show="!user"></div>
        <div class="col-xs-12 paddingLR0px fontbold" ng-click="goMatrix(site)">
            <span ng-bind="lang.SITEDETAIL_LABEL_MATRIX"></span>
            <i class="fa fa-chevron-right"></i>
            <i class="fa fa-chevron-right"></i>
            <i class="fa fa-chevron-right"></i>
        </div>
        <div class="empty-xs"></div>
        <div class="col-xs-12 padding10px" style="border-radius:5px;background-color:white;" ng-show="getMsgPageNavs().total > 0">
            <div class="col-xs-12 paddingLR0px fontbold">
                <span ng-bind="lang.SITEDETAIL_LABEL_MSGBOARD"></span>
                <i class="fa fa-edit"></i>
            </div>
            <div class="col-xs-12 paddingLR0px" ng-repeat="msg in msgVisibles">
                <pre ng-bind="msg.words" style="margin-bottom: 0px;"></pre>
                <div class="text-right small" style="margin-bottom: 10px;">
                    <span ng-show="msg.replyToUser" ng-bind="lang.SITEDETAIL_LABEL_REPLYTO"></span>
                    <span ng-show="msg.replyToUser" ng-bind="msg.replyToUser.personal.nickName"></span>
                    <span>by </span>
                    <span ng-bind="msg.author.personal.nickName"></span>
                    <span>@</span>
                    <span ng-bind="msg.createdOn | sensitiveDatetime"></span>
                    <i class="fa fa-reply" ng-click="replyToClick(msg)"></i>
                    <i class="fa" style="margin-left:5px;" ng-class="{'fa-heart': msg.like.me, 'fa-heart-o': !msg.like.me}" ng-click="likeMessage(msg)"></i>
                    <span class="small" style="margin-left: -3px;" ng-bind="msg.like.count"></span>
                </div>
            </div>
            <div class="col-xs-12 text-right paddingLR0px" ng-show="getMsgPageNavs().max > 0">
                <ul class="pagination">
                    <li ng-class="{disabled: currentMsgPage == 0}" ng-click="currentMsgPage <= 0 || switchMsgPage(0)"><span class="fa fa-angle-double-left"></span></li>
                    <li ng-class="{disabled: currentMsgPage == 0}" ng-click="currentMsgPage <= 0 || switchMsgPage(currentMsgPage - 1)"><span class="fa fa-angle-left"></span></li>
                    <li ng-repeat="pg in getMsgPageNavs().nav" ng-class="{active: currentMsgPage == pg}" ng-click="pg == currentMsgPage || switchMsgPage(pg)"><span ng-bind="pg + 1"></span></li>
                    <li ng-class="{disabled: currentMsgPage == getMsgPageNavs().max}" ng-click="currentMsgPage >= getMsgPageNavs().max || switchMsgPage(currentMsgPage + 1)"><span class="fa fa-angle-right"></span></li>
                    <li ng-class="{disabled: currentMsgPage == getMsgPageNavs().max}" ng-click="currentMsgPage >= getMsgPageNavs().max || switchMsgPage(getMsgPageNavs().max)"><span class="fa fa-angle-double-right"></span></li>
                </ul>
            </div>
        </div>
        <div class="col-xs-12 paddingLR0px" ng-show="getMsgPageNavs().total == 0" ng-bind="lang.SITEDETAIL_MSG_NOMSG"></div>
        <div class="empty-xs"></div>
        <div class="col-xs-12 paddingLR0px">
            <div class="col-xs-12 paddingLR0px fontbold">
                <span ng-bind="lang.SITEDETAIL_LABEL_SENDMSG"></span>
                <i class="fa fa-comment-o"></i>
            </div>
            <div class="col-xs-12 paddingLR0px small" ng-init="replyToClick(null)" ng-show="replyToMsg">
                <i class="fa fa-times clickable remove" ng-click="replyToMsg = null"></i>
                <span ng-bind="lang.SITEDETAIL_LABEL_REPLYTO"></span>
                <span ng-bind="replyToMsg.author.personal.nickName"></span>
            </div>
            <div class="col-xs-12 paddingLR0px">
                <textarea class="form-control" ng-model="newMessage"></textarea>
            </div>
            <div class="col-xs-12 paddingLR0px marginT5px text-right">
                <span ng-show="!user" ng-bind="lang.SITEDETAIL_MSG_SENDMSGAFTERLOGIN"></span>
                <button class="btn btn-warning btn-xs" ng-show="user" ng-click="sendNewSiteMessage()" ng-disabled="sendingMsg">
                    <i class="fa fa-spinner fa-spin" ng-show="sendingMsg"></i>
                    <span ng-bind="lang.SITEDETAIL_BTN_SENDINGMSG" ng-show="sendingMsg"></span>
                    <span ng-bind="lang.SITEDETAIL_BTN_SENDMSG" ng-show="!sendingMsg"></span>
                </button>
                <button class="btn btn-danger btn-xs" ng-show="user" ng-click="newMessage = ''" ng-bind="lang.SITEDETAIL_BTN_RESETMSG" ng-disabled="sendingMsg"></button>
            </div>
        </div>
    </div>
    <div class="empty-sm"></div>
</div>